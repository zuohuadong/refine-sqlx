# Refine SQL

[English](#english) | [‰∏≠Êñá](#‰∏≠Êñá)

## English

A lightweight, cross-platform SQL data provider for [Refine](https://refine.dev) with native runtime support.

[![npm version](https://img.shields.io/npm/v/@refine-sqlx/sql.svg)](https://www.npmjs.com/package/@refine-sqlx/sql)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![TypeScript](https://img.shields.io/badge/TypeScript-Ready-blue.svg)](https://www.typescriptlang.org/)

## Features

- üöÄ **Cross-platform**: Works with Bun, Node.js, and Cloudflare Workers
- ‚ö° **Native performance**: Uses runtime-specific SQL drivers
- üîí **Type-safe**: Full TypeScript support with schema inference
- üì¶ **Lightweight**: Minimal dependencies and optimized bundle size
- üéØ **Simple**: Easy to use with raw SQL
- üîÑ **Transactions**: Built-in transaction support
- üîó **Chain Queries**: Fluent interface for building complex queries (optional)
- üîÑ **Polymorphic Relations**: Support for morphTo/morphMany relationships (optional)
- üõ°Ô∏è **ORM Compatibility**: Enhanced type-safe CRUD operations (optional)
- üì¶ **Modular**: Import only what you need with tree-shaking support

## Installation

```bash
npm install @@refine-sqlx/sqlx/sql
# or
bun add @@refine-sqlx/sqlx/sql
```

### Advanced Features (On-demand)

Import advanced features only when needed:

```typescript
// Import the main provider
import { createProvider } from '@@refine-sqlx/sqlx/sql';

// Optional: Polymorphic relations
import { SqlxMorphQuery } from '@refine-sqlx/sql/morph-query';

// Optional: Type-safe methods
import { SqlxTypedMethods } from '@refine-sqlx/sql/typed-methods';
```

### Optional Dependencies

Install database drivers based on your runtime:

```bash
# For Node.js with SQLite
npm install better-sqlite3

# Bun and Cloudflare Workers use built-in drivers
```

## Quick Start

### Basic Usage

```typescript
import { createRefineSQL } from '@@refine-sqlx/sqlx/sql';

// File database (Bun/Node.js)
const dataProvider = createRefineSQL('./database.db');

// In-memory database
const dataProvider = createRefineSQL(':memory:');

// Cloudflare D1 (Workers)
const dataProvider = createRefineSQL(env.DB);
```

### With Refine

```typescript
import { Refine } from '@refinedev/core';
import { createRefineSQL } from '@@refine-sqlx/sqlx/sql';

const dataProvider = createRefineSQL('./database.db');

function App() {
  return (
    <Refine
      dataProvider={dataProvider}
      resources={[
        {
          name: 'users',
          list: '/users',
          create: '/users/create',
          edit: '/users/edit/:id',
          show: '/users/show/:id',
        },
      ]}>
      {/* Your app components */}
    </Refine>
  );
}
```

## Database Schema

Create your tables using standard SQL:

```sql
-- users table
CREATE TABLE users (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  name TEXT NOT NULL,
  email TEXT UNIQUE NOT NULL,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

-- posts table
CREATE TABLE posts (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  title TEXT NOT NULL,
  content TEXT,
  user_id INTEGER REFERENCES users(id),
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

## Advanced Usage

### Custom SQL Queries

```typescript
// The data provider automatically handles CRUD operations
// based on your table structure and Refine's conventions

// For custom queries, you can access the underlying client:
const client = dataProvider.client;

// Raw SQL query
const result = await client.query('SELECT * FROM users WHERE active = ?', [
  true,
]);

// With transactions
await client.transaction(async tx => {
  await tx.execute('INSERT INTO users (name, email) VALUES (?, ?)', [
    'John',
    'john@example.com',
  ]);
  await tx.execute('INSERT INTO posts (title, user_id) VALUES (?, ?)', [
    'Hello World',
    1,
  ]);
});
```

### Filtering and Sorting

The data provider automatically converts Refine's filter and sort parameters to SQL:

```typescript
// This Refine query:
const { data } = useList({
  resource: 'users',
  filters: [
    { field: 'name', operator: 'contains', value: 'john' },
    { field: 'active', operator: 'eq', value: true },
  ],
  sorters: [{ field: 'created_at', order: 'desc' }],
  pagination: { current: 1, pageSize: 10 },
});

// Becomes this SQL:
// SELECT * FROM users
// WHERE name LIKE '%john%' AND active = true
// ORDER BY created_at DESC
// LIMIT 10 OFFSET 0
```

### Supported Filter Operators

- `eq` - Equal
- `ne` - Not equal
- `lt` - Less than
- `lte` - Less than or equal
- `gt` - Greater than
- `gte` - Greater than or equal
- `in` - In array
- `nin` - Not in array
- `contains` - Contains (LIKE %value%)
- `ncontains` - Not contains
- `startswith` - Starts with (LIKE value%)
- `endswith` - Ends with (LIKE %value)
- `between` - Between two values
- `null` - Is null
- `nnull` - Is not null

## Runtime Support

| Runtime            | SQLite Support | Driver         |
| ------------------ | -------------- | -------------- |
| Bun                | ‚úÖ             | bun:sqlite     |
| Node.js            | ‚úÖ             | better-sqlite3 |
| Cloudflare Workers | ‚úÖ             | D1 Database    |

## Configuration Options

```typescript
const dataProvider = createRefineSQL('./database.db', {
  // Enable debug logging
  debug: true,

  // Custom logger
  logger: (query, params) => {
    console.log('SQL:', query);
    console.log('Params:', params);
  },

  // Connection options (Node.js only)
  options: { readonly: false, fileMustExist: false, timeout: 5000 },
});
```

## Error Handling

```typescript
import { createRefineSQL } from '@@refine-sqlx/sqlx/sql';

try {
  const dataProvider = createRefineSQL('./database.db');
  const result = await dataProvider.getList({ resource: 'users' });
} catch (error) {
  console.error('Database error:', error.message);
}
```

## Migration from Other Providers

### From Simple REST

```typescript
// Before
const dataProvider = simpleRestProvider('http://localhost:3000/api');

// After
const dataProvider = createRefineSQL('./database.db');
```

### From Supabase

```typescript
// Before
const dataProvider = supabaseDataProvider(supabaseClient);

// After
const dataProvider = createRefineSQL('./database.db');
// Note: You'll need to migrate your data from Supabase to SQLite
```

## Examples

### Bun Application

```typescript
// server.ts
import { Hono } from 'hono';
import { createRefineSQL } from '@@refine-sqlx/sqlx/sql';

const app = new Hono();
const dataProvider = createRefineSQL('./app.db');

app.get('/api/users', async c => {
  const users = await dataProvider.getList({ resource: 'users' });
  return c.json(users);
});

export default app;
```

### Cloudflare Workers

```typescript
// worker.ts
import { createRefineSQL } from '@@refine-sqlx/sqlx/sql';

export default {
  async fetch(request: Request, env: Env): Promise<Response> {
    const dataProvider = createRefineSQL(env.DB);

    const users = await dataProvider.getList({ resource: 'users' });

    return new Response(JSON.stringify(users), {
      headers: { 'Content-Type': 'application/json' },
    });
  },
};
```

### Node.js with Express

```typescript
// server.js
import express from 'express';
import { createRefineSQL } from '@@refine-sqlx/sqlx/sql';

const app = express();
const dataProvider = createRefineSQL('./database.db');

app.get('/api/users', async (req, res) => {
  try {
    const users = await dataProvider.getList({ resource: 'users' });
    res.json(users);
  } catch (error) {
    res.status(500).json({ error: error.message });
  }
});

app.listen(3000);
```

## ORM Compatibility Features

The `@refine-sqlx/sql` package now includes enhanced ORM compatibility features for a more modern development experience:

### Chain Query Builder

```typescript
import createRefineSQL, {
  type EnhancedDataProvider,
  type TableSchema,
} from '@@refine-sqlx/sqlx/sql';

// Define your schema for type safety
interface MySchema extends TableSchema {
  users: {
    id: number;
    name: string;
    email: string;
    status: 'active' | 'inactive';
  };
}

const dataProvider: EnhancedDataProvider<MySchema> =
  createRefineSQL<MySchema>('./database.db');

// Chain query example
const activeUsers = await dataProvider
  .from<MySchema['users']>('users')
  .where('status', 'eq', 'active')
  .where('age', 'gte', 18)
  .orderBy('name', 'asc')
  .limit(10)
  .get();

// Aggregation queries
const userCount = await dataProvider
  .from('users')
  .where('status', 'eq', 'active')
  .count();
```

### Polymorphic Relationships

```typescript
// Load polymorphic relationships
const commentsWithRelations = await dataProvider
  .morphTo('comments', {
    typeField: 'commentable_type',
    idField: 'commentable_id',
    relationName: 'commentable',
    types: { post: 'posts', user: 'users' },
  })
  .get();
```

### Type-Safe Operations

```typescript
// Type-safe create
const newUser = await dataProvider.createTyped({
  resource: 'users',
  variables: {
    name: 'John Doe',
    email: 'john@example.com',
    status: 'active', // TypeScript ensures correct values
  },
});

// Type-safe queries
const users = await dataProvider.findManyTyped(
  'users',
  { status: 'active' },
  { limit: 10, orderBy: [{ field: 'created_at', order: 'desc' }] }
);
```

For complete documentation on ORM compatibility features, see the [ORM Compatibility Guide](../../docs/refine-sql/ORM_COMPATIBILITY.md) in the central documentation.

## Documentation

For comprehensive documentation, see:

- [Complete API Reference](../../docs/refine-sql/API.md)
- [Factory Migration Guide](../../docs/refine-sql/FACTORY_MIGRATION.md)
- [ORM Compatibility](../../docs/refine-sql/ORM_COMPATIBILITY.md)
- [Refine ORM Migration Guide](../../docs/refine-sql/REFINE_ORM_MIGRATION.md)
- [Bundle Size Optimization](../../docs/refine-sql/BUNDLE_SIZE_OPTIMIZATION.md)
- [All Documentation](../../docs/README.md)

## API Reference

### Main Functions

- `createRefineSQL(database, options?)` - Create SQL data provider

### Data Provider Methods

- `getList(params)` - Get paginated list of records
- `getOne(params)` - Get single record by ID
- `getMany(params)` - Get multiple records by IDs
- `create(params)` - Create new record
- `createMany(params)` - Create multiple records
- `update(params)` - Update existing record
- `updateMany(params)` - Update multiple records
- `deleteOne(params)` - Delete single record
- `deleteMany(params)` - Delete multiple records

### Enhanced ORM Methods

- `from(table)` - Create chain query builder
- `morphTo(table, config)` - Create polymorphic query
- `getTyped(params)` - Type-safe get operation
- `createTyped(params)` - Type-safe create operation
- `updateTyped(params)` - Type-safe update operation
- `findTyped(table, conditions)` - Find single record
- `findManyTyped(table, conditions, options)` - Find multiple records
- `existsTyped(table, conditions)` - Check record existence

### Client Methods

- `client.query(sql, params?)` - Execute SELECT query
- `client.execute(sql, params?)` - Execute INSERT/UPDATE/DELETE
- `client.transaction(callback)` - Execute in transaction
- `client.batch(statements)` - Execute batch of statements

## Troubleshooting

### Common Issues

1. **File not found error**

   ```typescript
   // Make sure the database file exists or use :memory:
   const dataProvider = createRefineSQL(':memory:');
   ```

2. **Permission errors**

   ```bash
   # Ensure the process has write permissions to the database file
   chmod 666 database.db
   ```

3. **Better-sqlite3 installation issues**
   ```bash
   # For Node.js, make sure better-sqlite3 is installed
   npm install better-sqlite3
   ```

## Contributing

We welcome contributions! Please see our [Contributing Guide](../../CONTRIBUTING.md) for details.

## License

## MIT ¬© [RefineORM Team](https://github.com/zuohuadong/@refine-sqlx/sql)

## ‰∏≠Êñá

‰∏Ä‰∏™ËΩªÈáèÁ∫ß„ÄÅË∑®Âπ≥Âè∞ÁöÑ [Refine](https://refine.dev) SQL Êï∞ÊçÆÊèê‰æõÂô®ÔºåÊîØÊåÅÂéüÁîüËøêË°åÊó∂„ÄÇ

[![npm version](https://img.shields.io/npm/v/@refine-sqlx/sql.svg)](https://www.npmjs.com/package/@refine-sqlx/sql)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![TypeScript](https://img.shields.io/badge/TypeScript-Ready-blue.svg)](https://www.typescriptlang.org/)

## ÂäüËÉΩÁâπÊÄß

- üöÄ **Ë∑®Âπ≥Âè∞**: ÊîØÊåÅ Bun„ÄÅNode.js Âíå Cloudflare Workers
- ‚ö° **ÂéüÁîüÊÄßËÉΩ**: ‰ΩøÁî®ËøêË°åÊó∂ÁâπÂÆöÁöÑ SQL È©±Âä®
- üîí **Á±ªÂûãÂÆâÂÖ®**: ÂÆåÊï¥ÁöÑ TypeScript ÊîØÊåÅÂíåÊ®°ÂºèÊé®Êñ≠
- üì¶ **Ë∂ÖËΩªÈáèÁ∫ß**: Ê†∏ÂøÉÁâàÊú¨‰ªÖ ~3kBÔºåÂÆåÊï¥ÁâàÊú¨ ~23kB
- üéØ **ÁÆÄÂçï**: Êòì‰∫é‰ΩøÁî®ÂéüÁîü SQL
- üîÑ **‰∫ãÂä°**: ÂÜÖÁΩÆ‰∫ãÂä°ÊîØÊåÅ
- üîó **ÈìæÂºèÊü•ËØ¢**: ÊûÑÂª∫Â§çÊùÇÊü•ËØ¢ÁöÑÊµÅÁïÖÊé•Âè£ÔºàÂèØÈÄâÔºâ
- üîÑ **Â§öÊÄÅÂÖ≥Á≥ª**: ÊîØÊåÅ morphTo/morphMany ÂÖ≥Á≥ªÔºàÂèØÈÄâÔºâ
- üõ°Ô∏è **ORM ÂÖºÂÆπÊÄß**: Â¢ûÂº∫ÁöÑÁ±ªÂûãÂÆâÂÖ® CRUD Êìç‰ΩúÔºàÂèØÈÄâÔºâ
- üì¶ **Ê®°ÂùóÂåñ**: ÈÄöËøá tree-shaking ÊîØÊåÅÊåâÈúÄÂØºÂÖ•

## ÂÆâË£Ö

```bash
npm install @@refine-sqlx/sqlx/sql
# Êàñ
bun add @@refine-sqlx/sqlx/sql
```

## ÂåÖÂ§ßÂ∞è‰ºòÂåñ

Ê†πÊçÆÊÇ®ÁöÑÈúÄÊ±ÇÈÄâÊã©ÂêàÈÄÇÁöÑÁâàÊú¨Ôºö

```typescript
// ÂØºÂÖ•‰∏ªË¶ÅÊèê‰æõÂô®
import { createProvider } from '@@refine-sqlx/sqlx/sql';
```

### ÂèØÈÄâ‰æùËµñ

Ê†πÊçÆÊÇ®ÁöÑËøêË°åÊó∂ÂÆâË£ÖÊï∞ÊçÆÂ∫ìÈ©±Âä®Ôºö

```bash
# Áî®‰∫é Node.js ÁöÑ SQLite
npm install better-sqlite3

# Bun Âíå Cloudflare Workers ‰ΩøÁî®ÂÜÖÁΩÆÈ©±Âä®
```

## Âø´ÈÄüÂºÄÂßã

### Âü∫Á°ÄÁî®Ê≥ï

```typescript
import { createRefineSQL } from '@@refine-sqlx/sqlx/sql';

// Êñá‰ª∂Êï∞ÊçÆÂ∫ì (Bun/Node.js)
const dataProvider = createRefineSQL('./database.db');

// ÂÜÖÂ≠òÊï∞ÊçÆÂ∫ì
const dataProvider = createRefineSQL(':memory:');

// Cloudflare D1 (Workers)
const dataProvider = createRefineSQL(env.DB);
```

### ‰∏é Refine ‰∏ÄËµ∑‰ΩøÁî®

```typescript
import { Refine } from '@refinedev/core';
import { createRefineSQL } from '@@refine-sqlx/sqlx/sql';

const dataProvider = createRefineSQL('./database.db');

function App() {
  return (
    <Refine
      dataProvider={dataProvider}
      resources={[
        {
          name: 'users',
          list: '/users',
          create: '/users/create',
          edit: '/users/edit/:id',
          show: '/users/show/:id',
        },
      ]}>
      {/* ÊÇ®ÁöÑÂ∫îÁî®ÁªÑ‰ª∂ */}
    </Refine>
  );
}
```

## Êï∞ÊçÆÂ∫ìÊ®°Âºè

‰ΩøÁî®Ê†áÂáÜ SQL ÂàõÂª∫Ë°®Ôºö

```sql
-- Áî®Êà∑Ë°®
CREATE TABLE users (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  name TEXT NOT NULL,
  email TEXT UNIQUE NOT NULL,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

-- ÊñáÁ´†Ë°®
CREATE TABLE posts (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  title TEXT NOT NULL,
  content TEXT,
  user_id INTEGER REFERENCES users(id),
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

## È´òÁ∫ßÁî®Ê≥ï

### Ëá™ÂÆö‰πâ SQL Êü•ËØ¢

```typescript
// Êï∞ÊçÆÊèê‰æõÂô®Ëá™Âä®Â§ÑÁêÜÂü∫‰∫éË°®ÁªìÊûÑÂíå Refine Á∫¶ÂÆöÁöÑ CRUD Êìç‰Ωú

// ÂØπ‰∫éËá™ÂÆö‰πâÊü•ËØ¢ÔºåÊÇ®ÂèØ‰ª•ËÆøÈóÆÂ∫ïÂ±ÇÂÆ¢Êà∑Á´ØÔºö
const client = dataProvider.client;

// ÂéüÁîü SQL Êü•ËØ¢
const result = await client.query('SELECT * FROM users WHERE active = ?', [
  true,
]);

// ‰ΩøÁî®‰∫ãÂä°
await client.transaction(async tx => {
  await tx.execute('INSERT INTO users (name, email) VALUES (?, ?)', [
    'John',
    'john@example.com',
  ]);
  await tx.execute('INSERT INTO posts (title, user_id) VALUES (?, ?)', [
    'Hello World',
    1,
  ]);
});
```

### ËøáÊª§ÂíåÊéíÂ∫è

Êï∞ÊçÆÊèê‰æõÂô®Ëá™Âä®Â∞Ü Refine ÁöÑËøáÊª§Âô®ÂíåÊéíÂ∫èÂèÇÊï∞ËΩ¨Êç¢‰∏∫ SQLÔºö

```typescript
// Ëøô‰∏™ Refine Êü•ËØ¢Ôºö
const { data } = useList({
  resource: 'users',
  filters: [
    { field: 'name', operator: 'contains', value: 'john' },
    { field: 'active', operator: 'eq', value: true },
  ],
  sorters: [{ field: 'created_at', order: 'desc' }],
  pagination: { current: 1, pageSize: 10 },
});

// ËΩ¨Êç¢‰∏∫Ëøô‰∏™ SQLÔºö
// SELECT * FROM users
// WHERE name LIKE '%john%' AND active = true
// ORDER BY created_at DESC
// LIMIT 10 OFFSET 0
```

### ÊîØÊåÅÁöÑËøáÊª§Êìç‰ΩúÁ¨¶

- `eq` - Á≠â‰∫é
- `ne` - ‰∏çÁ≠â‰∫é
- `lt` - Â∞è‰∫é
- `lte` - Â∞è‰∫éÁ≠â‰∫é
- `gt` - Â§ß‰∫é
- `gte` - Â§ß‰∫éÁ≠â‰∫é
- `in` - Âú®Êï∞ÁªÑ‰∏≠
- `nin` - ‰∏çÂú®Êï∞ÁªÑ‰∏≠
- `contains` - ÂåÖÂê´ (LIKE %value%)
- `ncontains` - ‰∏çÂåÖÂê´
- `startswith` - ÂºÄÂßã‰∫é (LIKE value%)
- `endswith` - ÁªìÊùü‰∫é (LIKE %value)
- `between` - Âú®‰∏§‰∏™ÂÄº‰πãÈó¥
- `null` - ‰∏∫Á©∫
- `nnull` - ‰∏ç‰∏∫Á©∫

## ËøêË°åÊó∂ÊîØÊåÅ

| ËøêË°åÊó∂             | SQLite ÊîØÊåÅ | È©±Âä®           |
| ------------------ | ----------- | -------------- |
| Bun                | ‚úÖ          | bun:sqlite     |
| Node.js            | ‚úÖ          | better-sqlite3 |
| Cloudflare Workers | ‚úÖ          | D1 Êï∞ÊçÆÂ∫ì      |

## ÈÖçÁΩÆÈÄâÈ°π

```typescript
const dataProvider = createRefineSQL('./database.db', {
  // ÂêØÁî®Ë∞ÉËØïÊó•Âøó
  debug: true,

  // Ëá™ÂÆö‰πâÊó•ÂøóËÆ∞ÂΩïÂô®
  logger: (query, params) => {
    console.log('SQL:', query);
    console.log('ÂèÇÊï∞:', params);
  },

  // ËøûÊé•ÈÄâÈ°πÔºà‰ªÖ Node.jsÔºâ
  options: { readonly: false, fileMustExist: false, timeout: 5000 },
});
```

## ÈîôËØØÂ§ÑÁêÜ

```typescript
import { createRefineSQL } from '@@refine-sqlx/sqlx/sql';

try {
  const dataProvider = createRefineSQL('./database.db');
  const result = await dataProvider.getList({ resource: 'users' });
} catch (error) {
  console.error('Êï∞ÊçÆÂ∫ìÈîôËØØ:', error.message);
}
```

## ‰ªéÂÖ∂‰ªñÊèê‰æõÂô®ËøÅÁßª

### ‰ªé Simple REST

```typescript
// ‰πãÂâç
const dataProvider = simpleRestProvider('http://localhost:3000/api');

// ‰πãÂêé
const dataProvider = createRefineSQL('./database.db');
```

### ‰ªé Supabase

```typescript
// ‰πãÂâç
const dataProvider = supabaseDataProvider(supabaseClient);

// ‰πãÂêé
const dataProvider = createRefineSQL('./database.db');
// Ê≥®ÊÑèÔºöÊÇ®ÈúÄË¶ÅÂ∞ÜÊï∞ÊçÆ‰ªé Supabase ËøÅÁßªÂà∞ SQLite
```

## Á§∫‰æã

### Bun Â∫îÁî®

```typescript
// server.ts
import { Hono } from 'hono';
import { createRefineSQL } from '@@refine-sqlx/sqlx/sql';

const app = new Hono();
const dataProvider = createRefineSQL('./app.db');

app.get('/api/users', async c => {
  const users = await dataProvider.getList({ resource: 'users' });
  return c.json(users);
});

export default app;
```

### Cloudflare Workers

```typescript
// worker.ts
import { createRefineSQL } from '@@refine-sqlx/sqlx/sql';

export default {
  async fetch(request: Request, env: Env): Promise<Response> {
    const dataProvider = createRefineSQL(env.DB);

    const users = await dataProvider.getList({ resource: 'users' });

    return new Response(JSON.stringify(users), {
      headers: { 'Content-Type': 'application/json' },
    });
  },
};
```

### Node.js ‰∏é Express

```typescript
// server.js
import express from 'express';
import { createRefineSQL } from '@@refine-sqlx/sqlx/sql';

const app = express();
const dataProvider = createRefineSQL('./database.db');

app.get('/api/users', async (req, res) => {
  try {
    const users = await dataProvider.getList({ resource: 'users' });
    res.json(users);
  } catch (error) {
    res.status(500).json({ error: error.message });
  }
});

app.listen(3000);
```

## ORM ÂÖºÂÆπÊÄßÂäüËÉΩ

`@refine-sqlx/sql` ÂåÖÁé∞Âú®ÂåÖÂê´Â¢ûÂº∫ÁöÑ ORM ÂÖºÂÆπÊÄßÂäüËÉΩÔºåÊèê‰æõÊõ¥Áé∞‰ª£ÁöÑÂºÄÂèë‰ΩìÈ™åÔºö

### ÈìæÂºèÊü•ËØ¢ÊûÑÂª∫Âô®

```typescript
import createRefineSQL, {
  type EnhancedDataProvider,
  type TableSchema,
} from '@@refine-sqlx/sqlx/sql';

// ‰∏∫Á±ªÂûãÂÆâÂÖ®ÂÆö‰πâÊÇ®ÁöÑÊ®°Âºè
interface MySchema extends TableSchema {
  users: {
    id: number;
    name: string;
    email: string;
    status: 'active' | 'inactive';
  };
}

const dataProvider: EnhancedDataProvider<MySchema> =
  createRefineSQL<MySchema>('./database.db');

// ÈìæÂºèÊü•ËØ¢Á§∫‰æã
const activeUsers = await dataProvider
  .from<MySchema['users']>('users')
  .where('status', 'eq', 'active')
  .where('age', 'gte', 18)
  .orderBy('name', 'asc')
  .limit(10)
  .get();

// ËÅöÂêàÊü•ËØ¢
const userCount = await dataProvider
  .from('users')
  .where('status', 'eq', 'active')
  .count();
```

### Â§öÊÄÅÂÖ≥Á≥ª

```typescript
// Âä†ËΩΩÂ§öÊÄÅÂÖ≥Á≥ª
const commentsWithRelations = await dataProvider
  .morphTo('comments', {
    typeField: 'commentable_type',
    idField: 'commentable_id',
    relationName: 'commentable',
    types: { post: 'posts', user: 'users' },
  })
  .get();
```

### Á±ªÂûãÂÆâÂÖ®Êìç‰Ωú

```typescript
// Á±ªÂûãÂÆâÂÖ®ÂàõÂª∫
const newUser = await dataProvider.createTyped({
  resource: 'users',
  variables: {
    name: 'John Doe',
    email: 'john@example.com',
    status: 'active', // TypeScript Á°Æ‰øùÊ≠£Á°ÆÁöÑÂÄº
  },
});

// Á±ªÂûãÂÆâÂÖ®Êü•ËØ¢
const users = await dataProvider.findManyTyped(
  'users',
  { status: 'active' },
  { limit: 10, orderBy: [{ field: 'created_at', order: 'desc' }] }
);
```

ÊúâÂÖ≥ ORM ÂÖºÂÆπÊÄßÂäüËÉΩÁöÑÂÆåÊï¥ÊñáÊ°£ÔºåËØ∑ÂèÇÈòÖ [ORM_COMPATIBILITY.md](./ORM_COMPATIBILITY.md)„ÄÇ

## API ÂèÇËÄÉ

### ‰∏ªË¶ÅÂáΩÊï∞

- `createRefineSQL(database, options?)` - ÂàõÂª∫ SQL Êï∞ÊçÆÊèê‰æõÂô®

### Êï∞ÊçÆÊèê‰æõÂô®ÊñπÊ≥ï

- `getList(params)` - Ëé∑ÂèñÂàÜÈ°µËÆ∞ÂΩïÂàóË°®
- `getOne(params)` - ÈÄöËøá ID Ëé∑ÂèñÂçï‰∏™ËÆ∞ÂΩï
- `getMany(params)` - ÈÄöËøá ID Ëé∑ÂèñÂ§ö‰∏™ËÆ∞ÂΩï
- `create(params)` - ÂàõÂª∫Êñ∞ËÆ∞ÂΩï
- `createMany(params)` - ÂàõÂª∫Â§ö‰∏™ËÆ∞ÂΩï
- `update(params)` - Êõ¥Êñ∞Áé∞ÊúâËÆ∞ÂΩï
- `updateMany(params)` - Êõ¥Êñ∞Â§ö‰∏™ËÆ∞ÂΩï
- `deleteOne(params)` - Âà†Èô§Âçï‰∏™ËÆ∞ÂΩï
- `deleteMany(params)` - Âà†Èô§Â§ö‰∏™ËÆ∞ÂΩï

### Â¢ûÂº∫ ORM ÊñπÊ≥ï

- `from(table)` - ÂàõÂª∫ÈìæÂºèÊü•ËØ¢ÊûÑÂª∫Âô®
- `morphTo(table, config)` - ÂàõÂª∫Â§öÊÄÅÊü•ËØ¢
- `getTyped(params)` - Á±ªÂûãÂÆâÂÖ®Ëé∑ÂèñÊìç‰Ωú
- `createTyped(params)` - Á±ªÂûãÂÆâÂÖ®ÂàõÂª∫Êìç‰Ωú
- `updateTyped(params)` - Á±ªÂûãÂÆâÂÖ®Êõ¥Êñ∞Êìç‰Ωú
- `findTyped(table, conditions)` - Êü•ÊâæÂçï‰∏™ËÆ∞ÂΩï
- `findManyTyped(table, conditions, options)` - Êü•ÊâæÂ§ö‰∏™ËÆ∞ÂΩï
- `existsTyped(table, conditions)` - Ê£ÄÊü•ËÆ∞ÂΩïÂ≠òÂú®ÊÄß

### ÂÆ¢Êà∑Á´ØÊñπÊ≥ï

- `client.query(sql, params?)` - ÊâßË°å SELECT Êü•ËØ¢
- `client.execute(sql, params?)` - ÊâßË°å INSERT/UPDATE/DELETE
- `client.transaction(callback)` - Âú®‰∫ãÂä°‰∏≠ÊâßË°å
- `client.batch(statements)` - ÊâßË°åÊâπÈáèËØ≠Âè•

## ÊïÖÈöúÊéíÈô§

### Â∏∏ËßÅÈóÆÈ¢ò

1. **Êñá‰ª∂Êú™ÊâæÂà∞ÈîôËØØ**

   ```typescript
   // Á°Æ‰øùÊï∞ÊçÆÂ∫ìÊñá‰ª∂Â≠òÂú®Êàñ‰ΩøÁî® :memory:
   const dataProvider = createRefineSQL(':memory:');
   ```

2. **ÊùÉÈôêÈîôËØØ**

   ```bash
   # Á°Æ‰øùËøõÁ®ãÂØπÊï∞ÊçÆÂ∫ìÊñá‰ª∂ÊúâÂÜôÊùÉÈôê
   chmod 666 database.db
   ```

3. **Better-sqlite3 ÂÆâË£ÖÈóÆÈ¢ò**
   ```bash
   # ÂØπ‰∫é Node.jsÔºåÁ°Æ‰øùÂÆâË£Ö‰∫Ü better-sqlite3
   npm install better-sqlite3
   ```

## Ë¥°ÁåÆ

Êàë‰ª¨Ê¨¢ËøéË¥°ÁåÆÔºÅËØ∑Êü•ÁúãÊàë‰ª¨ÁöÑ [Ë¥°ÁåÆÊåáÂçó](../../CONTRIBUTING.md) ‰∫ÜËß£ËØ¶ÊÉÖ„ÄÇ

## ËÆ∏ÂèØËØÅ

MIT ¬© [RefineORM Team](https://github.com/zuohuadong/@refine-sqlx/sql)
